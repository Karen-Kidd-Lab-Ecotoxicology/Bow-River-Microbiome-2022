1. Installing Virtual Box (Linux emulator):

Download and install virtual box for Windows using this link: 


https://www.virtualbox.org/wiki/Downloads

Make sure you remember and write down your sudo password! You need it to install packages to the computer.
If you forget it you have to go into the GRUB (start up menu) by restarting the computer and holding the shift or ESC key




2. Installing conda:

Download the .sh file (Anaconda for Linux) from this link:

https://www.anaconda.com/download/#linux


Follow this tutorial in the command terminal in your Linux system: 

https://docs.anaconda.com/free/anaconda/install/linux/


Commands:
emilie@emilie-VirtualBox:~$ shasum -a 256 /home/emilie/Downloads/Anaconda3-2023.03-1-Linux-x86_64.sh


emilie@emilie-VirtualBox:~$ bash ~/Downloads/Anaconda3-2023.03-1-Linux-x86_64.sh

emilie@emilie-VirtualBox:~$ ~/.bashrc




3. Installing PICRUSt2:

There are different ways of installing picrust2 including using a QIIME2 plugin, Mambaforge from bioconda or from source. Trying from bioconda with and without using mamba. 

Steps from source:

Download Mambaforge for Linux using this link: https://github.com/conda-forge/miniforge#mambaforge

Follow the tutorial for installation instructions from this link: https://mamba.readthedocs.io/en/latest/installation.html


Commands:
(base) emilie@emilie-VirtualBox:~$ conda install -n base --override-channels -c conda-forge mamba 'python_abi=*=*cp*'

 *This took a very long time to solve the environment but eventually worked*

Download the tar.gz zip file into the anaconda3 directory to install picrust2 from source using this link: https://github.com/picrust/picrust2/releases

Follow this tutorial for installation instructions: https://github.com/picrust/picrust2/wiki/Installation


To load your environment you need to call it in from Conda using this code:

conda activate /path/to/environment

ex. emilie@emilie-VirtualBox:~$ conda activate /home/emilie/micromamba/envs/picrust2




4. Running PICRUSt2:

Requires two very pricesly formatted data files. One is a FASTA file (.fasta or .fna extension) that is a converted dataframe with the first column as a unique ASV identifier (ex. "ASV1", "ASV2", "ASV3", etc.) and the second column as the corresponding amplicon DNA sequence. 

The other file is a .BIOM or .tsv file with the otu table. The first column in the otu table should match the ASV IDs from the FASTA file. 


There is only one line of code that will run all analyses. 

Command once your data is formatted correctly:

picrust2_pipeline.py -s study_seqs.fna -i study_seqs.biom -o picrust2_out_pipeline -p 1


You need to be in the picrust2 envioronment and locate your directory to where your files are stored. To change your working directory you can use this code:

emilie@emilie-VirtualBox:~$ cd /home/emilie/Documents


If you get an error that says "all X sequences aligned poorly to reference" then either your fasta file headers contain a special character that shouldn't be there or your 
reads may not be all from the positive strand. Mine were on the negative strand so I had to reverse complement them before running the pipeline again. 

To do that, first you need to install git:
(base) emilie@emilie-VirtualBox:-$ sudo apt install git

Then install "seqtk":
(base) emilie@emilie-VirtualBox: ~$ sudo apt install seqtk

Clone the Git repo for seqtk
(base) emilie@emilie-VirtualBox:~$ git clone https://github.com/lh3/seqtk.git;
                                   cd seqtk; make

Finally, this code runs the reverse complement on FASTA or Q files:
(base) emilie@emilie-VirtualBox: seqtk seq -r ASV_sequences.fna > ASV_sequences_pos.fna

